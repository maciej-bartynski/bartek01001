import express from 'express';
import { CRUDServer } from 'crud-server';

const app = express();
app.use(express.json());

const crudServer = new CRUDServer();
crudServer.configure({ dataDirectory: 'data' });

// Create CRUD endpoints for 'users'
await crudServer.path('users');

// Mount the CRUD routes
app.use('/api', crudServer.app());

app.listen(3000, () => {
  console.log('Server running on port 3000');
  console.log('');
  console.log('=== COMPLETE CRUD OPERATIONS GUIDE ===');
  console.log('');
  console.log('ENDPOINT: /api/users');
  console.log('');
  console.log('1. CREATE (POST /api/users)');
  console.log('   Request:');
  console.log('   curl -X POST http://localhost:3000/api/users \\');
  console.log('     -H "Content-Type: application/json" \\');
  console.log('     -d \'{"name": "John Doe", "email": "john@example.com", "age": 30}\'');
  console.log('');
  console.log('   Response:');
  console.log('   {');
  console.log('     "item": {');
  console.log('       "_id": "generated-uuid",');
  console.log('       "name": "John Doe",');
  console.log('       "email": "john@example.com",');
  console.log('       "age": 30');
  console.log('     }');
  console.log('   }');
  console.log('');
  console.log('2. READ ALL (GET /api/users)');
  console.log('   Request:');
  console.log('   curl http://localhost:3000/api/users');
  console.log('');
  console.log('   Response:');
  console.log('   {');
  console.log('     "items": [');
  console.log('       {');
  console.log('         "_id": "uuid-1",');
  console.log('         "name": "John Doe",');
  console.log('         "email": "john@example.com",');
  console.log('         "age": 30');
  console.log('       }');
  console.log('     ]');
  console.log('   }');
  console.log('');
  console.log('3. READ ONE (GET /api/users/{id})');
  console.log('   Request:');
  console.log('   curl http://localhost:3000/api/users/uuid-1');
  console.log('');
  console.log('   Response:');
  console.log('   {');
  console.log('     "item": {');
  console.log('       "_id": "uuid-1",');
  console.log('         "name": "John Doe",');
  console.log('         "email": "john@example.com",');
  console.log('         "age": 30');
  console.log('     }');
  console.log('   }');
  console.log('');
  console.log('4. UPDATE (PUT /api/users/{id})');
  console.log('   Request:');
  console.log('   curl -X PUT http://localhost:3000/api/users/uuid-1 \\');
  console.log('     -H "Content-Type: application/json" \\');
  console.log('     -d \'{"age": 31, "email": "john.updated@example.com"}\'');
  console.log('');
  console.log('   Response:');
  console.log('   {');
  console.log('     "item": {');
  console.log('       "_id": "uuid-1",');
  console.log('       "name": "John Doe",');
  console.log('       "email": "john.updated@example.com",');
  console.log('       "age": 31');
  console.log('     }');
  console.log('   }');
  console.log('');
  console.log('5. DELETE (DELETE /api/users/{id})');
  console.log('   Request:');
  console.log('   curl -X DELETE http://localhost:3000/api/users/uuid-1');
  console.log('');
  console.log('   Response:');
  console.log('   {');
  console.log('     "deleted": true,');
  console.log('     "_id": "uuid-1"');
  console.log('   }');
  console.log('');
  console.log('=== TESTING WITH BROWSER ===');
  console.log('You can also test these endpoints in your browser:');
  console.log('- GET http://localhost:3000/api/users (view all users)');
  console.log('- GET http://localhost:3000/api/users/{id} (view specific user)');
  console.log('');
  console.log('=== TESTING WITH POSTMAN ===');
  console.log('Import these requests into Postman for easy testing!');
});
